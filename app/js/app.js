/*!
 * 
 * clickplus dmp
 * 
 * Author: shenbin
 * 
 */
if("undefined"==typeof $)throw new Error("This application's JavaScript requires jQuery");angular.module("clickplus",["ngRoute","ngAnimate","ngStorage","ngCookies","ui.bootstrap","ui.router","oc.lazyLoad","cfp.loadingBar","ngSanitize","ngResource"]),angular.module("clickplus").run(["$rootScope","$state","$stateParams","$window","$templateCache",function(e,n,a,t,o){e.$state=n,e.$stateParams=a,e.$storage=t.localStorage,e.app={name:"clikplus dmp",description:"Angular Bootstrap Admin Template",year:(new Date).getFullYear(),layout:{isFixed:!0,isCollapsed:!1,isBoxed:!1,isRTL:!1,horizontal:!1,isFloat:!1,asideHover:!1,theme:"app/css/theme-clickplus.css"},useFullLayout:!1,hiddenFooter:!1,viewAnimation:"ng-fadeInUp"},e.user={name:"admin"},e.menuItems=[{text:"我的标签",sref:"tag.list"},{text:"我的人群",sref:"people.list"}];var i=function(e){var a=e.sref.split(".");return n.includes(a[0])};e.getMenuItemPropClasses=function(e){return i(e)?" active":""}}]),angular.module("clickplus").config(["$stateProvider","$locationProvider","$urlRouterProvider","RouteHelpersProvider",function(e,n,a,t){"use strict";a.otherwise("/tag/list"),e.state("tag",{url:"/tag",templateUrl:t.basepath("tag.html"),controller:"AppController"}).state("tag.list",{url:"/list",title:"我的全部标签",templateUrl:t.basepath("tag-list.html"),controller:"TagListController",resolve:t.resolveFor("datatables")}).state("tag.import",{url:"/import",title:"导入标签",templateUrl:t.basepath("tag-import.html"),controller:"TagImportController",resolve:t.resolveFor("fileupload")}).state("tag.add",{url:"/add",title:"新建标签",templateUrl:t.basepath("tag-add.html"),controller:"TagAddController",resolve:t.resolveFor("ui.select","datetime")}).state("tag.edit",{url:"/edit/{tagid}",title:"修改标签",templateUrl:t.basepath("tag-edit.html"),controller:"TagEditController",resolve:t.resolveFor("ui.select","datetime")}).state("people",{url:"/people",templateUrl:t.basepath("people.html"),controller:"AppController"}).state("people.list",{url:"/list",title:"我创建的人群",templateUrl:t.basepath("people-list.html"),controller:"PeopleListController",resolve:t.resolveFor("datatables")}).state("people.add",{url:"/add",title:"新建营销人群",templateUrl:t.basepath("people-add.html"),controller:"PeopleAddController"}).state("people.edit",{url:"/edit/{id}",title:"修改营销人群",templateUrl:t.basepath("people-edit.html"),controller:"PeopleEditController"})}]).config(["$ocLazyLoadProvider","APP_REQUIRES",function(e,n){"use strict";e.config({debug:!1,events:!0,modules:n.modules})}]).config(["$controllerProvider","$compileProvider","$filterProvider","$provide",function(e,n,a,t){"use strict";angular.module("clickplus").controller=e.register,angular.module("clickplus").directive=n.directive,angular.module("clickplus").filter=a.register,angular.module("clickplus").factory=t.factory,angular.module("clickplus").service=t.service,angular.module("clickplus").constant=t.constant,angular.module("clickplus").value=t.value}]).config(["cfpLoadingBarProvider",function(e){e.includeBar=!0,e.includeSpinner=!0,e.latencyThreshold=500,e.parentSelector=".wrapper  section"}]).config(["$tooltipProvider",function(e){e.options({appendToBody:!0})}]),angular.module("clickplus").constant("APP_COLORS",{primary:"#5d9cec",success:"#27c24c",info:"#23b7e5",warning:"#ff902b",danger:"#f05050",inverse:"#131e26",green:"#37bc9b",pink:"#f532e5",purple:"#7266ba",dark:"#3a3f51",yellow:"#fad732","gray-darker":"#232735","gray-dark":"#3a3f51",gray:"#dde6e9","gray-light":"#e4eaec","gray-lighter":"#edf1f2"}).constant("REGION",{"西北地区":{640:{city:[{code:"Yinchuan",name:"银川市"},{code:"Shizuishan",name:"石嘴山市"},{code:"Wuzhong",name:"吴忠市"},{code:"Guyuan",name:"固原市"},{code:"Zhongwei",name:"中卫市"}],code:"Ningxia",name:"宁夏"},610:{city:[{code:"Xian",name:"西安市"},{code:"Tongchuan",name:"铜川市"},{code:"Baoji",name:"宝鸡市"},{code:"Xianyang",name:"咸阳市"},{code:"Weinan",name:"渭南市"},{code:"Yanan",name:"延安市"},{code:"Hanzhong",name:"汉中市"},{code:"Yulin",name:"榆林市"},{code:"Ankang",name:"安康市"},{code:"Shangluo",name:"商洛市"}],code:"Shanxi",name:"陕西"},620:{city:[{code:"Lanzhou",name:"兰州市"},{code:"Jiayuguan",name:"嘉峪关市"},{code:"Jinchang",name:"金昌市"},{code:"Baiyin",name:"白银市"},{code:"Tianshui",name:"天水市"},{code:"Wuwei",name:"武威市"},{code:"Zhangye",name:"张掖市"},{code:"Pinliang",name:"平凉市"},{code:"Jiuquan",name:"酒泉市"},{code:"Qingyang",name:"庆阳市"},{code:"Dingxi",name:"定西市"},{code:"Longnan",name:"陇南市"},{code:"Linxiahuizu",name:"临夏回族自治州"},{code:"Gannanzangzu",name:"甘南藏族自治州"}],code:"Gansu",name:"甘肃"},650:{city:[{code:"Wulumuqi",name:"乌鲁木齐市"},{code:"Kelamayi",name:"克拉玛依市"},{code:"Tulufan",name:"吐鲁番地区"},{code:"Hami",name:"哈密地区"},{code:"Changjihuizu",name:"昌吉回族自治州"},{code:"Boertalamenggu",name:"博尔塔拉蒙古自治州"},{code:"Bayinguolengmenggu",name:"巴音郭楞蒙古自治州"},{code:"Akesu",name:"阿克苏地区"},{code:"Kezilesukeerkezi",name:"克孜勒苏柯尔克孜自治州"},{code:"Kashi",name:"喀什地区"},{code:"Hetian",name:"和田地区"},{code:"Yilihasake",name:"伊犁哈萨克自治州"},{code:"Tacheng",name:"塔城地区"},{code:"Aletai",name:"阿勒泰地区"}],code:"Xinjiang",name:"新疆"},630:{city:[{code:"Xining",name:"西宁市"},{code:"Haidong",name:"海东地区"},{code:"Haibeizangzu",name:"海北藏族自治州"},{code:"Huangnanzangzu",name:"黄南藏族自治州"},{code:"Hainanzangzu",name:"海南藏族自治州"},{code:"Guoluozangzu",name:"果洛藏族自治州"},{code:"Yushuzangzu",name:"玉树藏族自治州"},{code:"Haiximengguzuzangzu",name:"海西蒙古族藏族自治州"}],code:"Qinghai",name:"青海"}},"华北地区":{120:{city:[{code:"Tianjin",name:"天津"}],code:"Tianjin",name:"天津"},130:{city:[{code:"Shijiazhuang",name:"石家庄市"},{code:"Tangshan",name:"唐山市"},{code:"Qinhuangdao",name:"秦皇岛市"},{code:"Handan",name:"邯郸市"},{code:"Xingtai",name:"邢台市"},{code:"Baoding",name:"保定市"},{code:"Zhangjiakou",name:"张家口市"},{code:"Chengde",name:"承德市"},{code:"Cangzhou",name:"沧州市"},{code:"Langfang",name:"廊坊市"},{code:"Hengshui",name:"衡水市"}],code:"Hebei",name:"河北"},140:{city:[{code:"Taiyuan",name:"太原市"},{code:"Datong",name:"大同市"},{code:"Yangquan",name:"阳泉市"},{code:"Changzhi",name:"长治市"},{code:"Jincheng",name:"晋城市"},{code:"Shuozhou",name:"朔州市"},{code:"Jinzhong",name:"晋中市"},{code:"Yuncheng",name:"运城市"},{code:"Xinzhou",name:"忻州市"},{code:"Linfen",name:"临汾市"},{code:"Lvliang",name:"吕梁市"}],code:"Shanxi",name:"山西"},150:{city:[{code:"Huhehaote",name:"呼和浩特市"},{code:"Baotou",name:"包头市"},{code:"Wuhai",name:"乌海市"},{code:"Chifeng",name:"赤峰市"},{code:"Tongliao",name:"通辽市"},{code:"Eerduosi",name:"鄂尔多斯市"},{code:"Hulunbeier",name:"呼伦贝尔市"},{code:"Bayanzhuoer",name:"巴彦淖尔市"},{code:"Wulanchabu",name:"乌兰察布市"},{code:"Xinganmeng",name:"兴安盟"},{code:"Xilinguolemeng",name:"锡林郭勒盟"},{code:"Alashanmeng",name:"阿拉善盟"}],code:"Neimenggu",name:"内蒙古"},110:{city:[{code:"Beijing",name:"北京"}],code:"Beijing",name:"北京"}},"西南地区":{520:{city:[{code:"Guiyang",name:"贵阳市"},{code:"Liupanshui",name:"六盘水市"},{code:"Zunyi",name:"遵义市"},{code:"Anshun",name:"安顺市"},{code:"Tongren",name:"铜仁地区"},{code:"Qianxinanbuyizumiaozu",name:"黔西南布依族苗族自治州"},{code:"Bijie",name:"毕节地区"},{code:"Qiandongnanmiaozudongzu",name:"黔东南苗族侗族自治州"},{code:"Qiannanbuyizumiaozu",name:"黔南布依族苗族自治州"}],code:"Guizhou",name:"贵州"},540:{city:[{code:"Lasa",name:"拉萨市"},{code:"Changdu",name:"昌都地区"},{code:"Shannan",name:"山南地区"},{code:"Rikeze",name:"日喀则地区"},{code:"Naqv",name:"那曲地区"},{code:"Ali",name:"阿里地区"},{code:"Linzhi",name:"林芝地区"}],code:"Xizang",name:"西藏"},530:{city:[{code:"Kunming",name:"昆明市"},{code:"Qvjing",name:"曲靖市"},{code:"Yuxi",name:"玉溪市"},{code:"Baoshan",name:"保山市"},{code:"Zhaotong",name:"昭通市"},{code:"Lijiang",name:"丽江市"},{code:"Puer",name:"普洱市"},{code:"Lincang",name:"临沧市"},{code:"Chuxiongyizu",name:"楚雄彝族自治州"},{code:"Honghehanizuyizu",name:"红河哈尼族彝族自治州"},{code:"Wenshanzhuangzumiaozu",name:"文山壮族苗族自治州"},{code:"Xishuangbannadaizu",name:"西双版纳傣族自治州"},{code:"Dalibaizu",name:"大理白族自治州"},{code:"Dehongdaizujingpozu",name:"德宏傣族景颇族自治州"},{code:"Nujianglisuzu",name:"怒江傈僳族自治州"},{code:"Diqingzangzu",name:"迪庆藏族自治州"}],code:"Yunnan",name:"云南"},500:{city:[{code:"Chongqing",name:"重庆"}],code:"Chongqing",name:"重庆"},510:{city:[{code:"Chengdu",name:"成都市"},{code:"Zigong",name:"自贡市"},{code:"Panzhihua",name:"攀枝花市"},{code:"Luzhou",name:"泸州市"},{code:"Deyang",name:"德阳市"},{code:"Mianyang",name:"绵阳市"},{code:"Guangyuan",name:"广元市"},{code:"Suining",name:"遂宁市"},{code:"Neijiang",name:"内江市"},{code:"Leshan",name:"乐山市"},{code:"Nanchong",name:"南充市"},{code:"Meishan",name:"眉山市"},{code:"Yibin",name:"宜宾市"},{code:"Guangan",name:"广安市"},{code:"Dazhou",name:"达州市"},{code:"Yaan",name:"雅安市"},{code:"Bazhong",name:"巴中市"},{code:"Ziyang",name:"资阳市"},{code:"Abazangzuqiangzu",name:"阿坝藏族羌族自治州"},{code:"Ganzizangzu",name:"甘孜藏族自治州"},{code:"Liangshanyizu",name:"凉山彝族自治州"}],code:"Sichuan",name:"四川"}},"华东地区":{320:{city:[{code:"Nanjing",name:"南京市"},{code:"Wuxi",name:"无锡市"},{code:"Xuzhou",name:"徐州市"},{code:"Changzhou",name:"常州市"},{code:"Suzhou",name:"苏州市"},{code:"Nantong",name:"南通市"},{code:"Lianyungang",name:"连云港市"},{code:"Huaian",name:"淮安市"},{code:"Yancheng",name:"盐城市"},{code:"Yangzhou",name:"扬州市"},{code:"Zhenjiang",name:"镇江市"},{code:"Taizhou",name:"泰州市"},{code:"Suqian",name:"宿迁市"}],code:"Jiangsu",name:"江苏"},330:{city:[{code:"Hangzhou",name:"杭州市"},{code:"Ningbo",name:"宁波市"},{code:"Wenzhou",name:"温州市"},{code:"Jiaxing",name:"嘉兴市"},{code:"Huzhou",name:"湖州市"},{code:"Shaoxing",name:"绍兴市"},{code:"Jinhua",name:"金华市"},{code:"Qvzhou",name:"衢州市"},{code:"Zhoushan",name:"舟山市"},{code:"Taizhou",name:"台州市"},{code:"Lishui",name:"丽水市"}],code:"Zhejiang",name:"浙江"},370:{city:[{code:"Jinan",name:"济南市"},{code:"Qingdao",name:"青岛市"},{code:"Zibo",name:"淄博市"},{code:"Zaozhuang",name:"枣庄市"},{code:"Dongying",name:"东营市"},{code:"Yantai",name:"烟台市"},{code:"Weifang",name:"潍坊市"},{code:"Jining",name:"济宁市"},{code:"Taian",name:"泰安市"},{code:"Weihai",name:"威海市"},{code:"Rizhao",name:"日照市"},{code:"Laiwu",name:"莱芜市"},{code:"Linyi",name:"临沂市"},{code:"Dezhou",name:"德州市"},{code:"Liaocheng",name:"聊城市"},{code:"Binzhou",name:"滨州市"},{code:"Heze",name:"菏泽市"}],code:"Shandong",name:"山东"},340:{city:[{code:"Hefei",name:"合肥市"},{code:"Wuhu",name:"芜湖市"},{code:"Bengbu",name:"蚌埠市"},{code:"Huainan",name:"淮南市"},{code:"Maanshan",name:"马鞍山市"},{code:"Huaibei",name:"淮北市"},{code:"Tongling",name:"铜陵市"},{code:"Anqing",name:"安庆市"},{code:"Huangshan",name:"黄山市"},{code:"Chuzhou",name:"滁州市"},{code:"Fuyang",name:"阜阳市"},{code:"suzhou",name:"宿州市"},{code:"Chaohu",name:"巢湖市"},{code:"Liuan",name:"六安市"},{code:"Bozhou",name:"亳州市"},{code:"Chizhou",name:"池州市"},{code:"Xuancheng",name:"宣城市"}],code:"Anhui",name:"安徽"},310:{city:[{code:"Shanghai",name:"上海"}],code:"Shanghai",name:"上海"},350:{city:[{code:"Fuzhou",name:"福州市"},{code:"Xiamen",name:"厦门市"},{code:"Putian",name:"莆田市"},{code:"Sanming",name:"三明市"},{code:"Quanzhou",name:"泉州市"},{code:"Zhangzhou",name:"漳州市"},{code:"Nanping",name:"南平市"},{code:"Longyan",name:"龙岩市"},{code:"Ningde",name:"宁德市"}],code:"Fujian",name:"福建"}},"其他地区":{810:{city:[{code:"Xianggang",name:"香港"}],code:"Xianggang",name:"香港"},820:{city:[{code:"Aomen",name:"澳门"}],code:"Aomen",name:"澳门"},710:{city:[{code:"Taibei",name:"台北市"},{code:"Xinbei",name:"新北市"},{code:"Taizhong",name:"台中市"},{code:"Tainan",name:"台南市"},{code:"Gaoxiong",name:"高雄市"},{code:"Jilong",name:"基隆市"},{code:"Jiayi",name:"嘉义市"},{code:"Xinzhu",name:"新竹市"}],code:"Taiwan",name:"台湾"}},"华南地区":{440:{city:[{code:"Guangzhou",name:"广州市"},{code:"Shaoguan",name:"韶关市"},{code:"Shenzhen",name:"深圳市"},{code:"Zhuhai",name:"珠海市"},{code:"Shantou",name:"汕头市"},{code:"Foshan",name:"佛山市"},{code:"Jiangmen",name:"江门市"},{code:"Zhanjiang",name:"湛江市"},{code:"Maoming",name:"茂名市"},{code:"Zhaoqing",name:"肇庆市"},{code:"Huizhou",name:"惠州市"},{code:"Meizhou",name:"梅州市"},{code:"Shanwei",name:"汕尾市"},{code:"Heyuan",name:"河源市"},{code:"Yangjiang",name:"阳江市"},{code:"Qingyuan",name:"清远市"},{code:"Dongguan",name:"东莞市"},{code:"Zhongshan",name:"中山市"},{code:"Chaozhou",name:"潮州市"},{code:"Jieyang",name:"揭阳市"},{code:"Yunfu",name:"云浮市"}],code:"Guangdong",name:"广东"},450:{city:[{code:"Nanning",name:"南宁市"},{code:"Liuzhou",name:"柳州市"},{code:"Guilin",name:"桂林市"},{code:"Wuzhou",name:"梧州市"},{code:"Beihai",name:"北海市"},{code:"Fangchenggang",name:"防城港市"},{code:"Qinzhou",name:"钦州市"},{code:"Guigang",name:"贵港市"},{code:"Yulin",name:"玉林市"},{code:"Baise",name:"百色市"},{code:"Hezhou",name:"贺州市"},{code:"Hechi",name:"河池市"},{code:"Laibin",name:"来宾市"},{code:"Chongzuo",name:"崇左市"}],code:"Guangxi",name:"广西"},460:{city:[{code:"Haikou",name:"海口市"},{code:"Sanya",name:"三亚市"}],code:"Hainan",name:"海南"}},"华中地区":{360:{city:[{code:"Nanchang",name:"南昌市"},{code:"Jingdezhen",name:"景德镇市"},{code:"Pingxiang",name:"萍乡市"},{code:"Jiujiang",name:"九江市"},{code:"Xinyu",name:"新余市"},{code:"Yingtan",name:"鹰潭市"},{code:"Ganzhou",name:"赣州市"},{code:"Jian",name:"吉安市"},{code:"Yichun",name:"宜春市"},{code:"Fuzhou",name:"抚州市"},{code:"Shangrao",name:"上饶市"}],code:"Jiangxi",name:"江西"},410:{city:[{code:"Zhengzhou",name:"郑州市"},{code:"Kaifeng",name:"开封市"},{code:"Luoyang",name:"洛阳市"},{code:"Pingdingshan",name:"平顶山市"},{code:"Anyang",name:"安阳市"},{code:"Hebi",name:"鹤壁市"},{code:"Xinxiang",name:"新乡市"},{code:"Jiaozuo",name:"焦作市"},{code:"Puyang",name:"濮阳市"},{code:"Xuchang",name:"许昌市"},{code:"Luohe",name:"漯河市"},{code:"Sanmenxia",name:"三门峡市"},{code:"Nanyang",name:"南阳市"},{code:"Shangqiu",name:"商丘市"},{code:"Xinyang",name:"信阳市"},{code:"Zhoukou",name:"周口市"},{code:"Zhumadian",name:"驻马店市"}],code:"Henan",name:"河南"},420:{city:[{code:"Wuhan",name:"武汉市"},{code:"Huangshi",name:"黄石市"},{code:"Shiyan",name:"十堰市"},{code:"Yichang",name:"宜昌市"},{code:"Xiangfan",name:"襄樊市"},{code:"Ezhou",name:"鄂州市"},{code:"Jingmen",name:"荆门市"},{code:"Xiaogan",name:"孝感市"},{code:"Jingzhou",name:"荆州市"},{code:"Huanggang",name:"黄冈市"},{code:"Xianning",name:"咸宁市"},{code:"Suizhou",name:"随州市"},{code:"Enshitujiazumiaozu",name:"恩施土家族苗族自治州"}],code:"Hubei",name:"湖北"},430:{city:[{code:"Changsha",name:"长沙市"},{code:"Zhuzhou",name:"株洲市"},{code:"Xiangtan",name:"湘潭市"},{code:"Hengyang",name:"衡阳市"},{code:"Shaoyang",name:"邵阳市"},{code:"Yueyang",name:"岳阳市"},{code:"Changde",name:"常德市"},{code:"Zhangjiajie",name:"张家界市"},{code:"Yiyang",name:"益阳市"},{code:"Chenzhou",name:"郴州市"},{code:"Yongzhou",name:"永州市"},{code:"Huaihua",name:"怀化市"},{code:"Loudi",name:"娄底市"},{code:"Xiangxitujiazumiaozu",name:"湘西土家族苗族自治州"}],code:"Hunan",name:"湖南"}},"东北地区":{210:{city:[{code:"Shenyang",name:"沈阳市"},{code:"Dalian",name:"大连市"},{code:"Anshan",name:"鞍山市"},{code:"Fushun",name:"抚顺市"},{code:"Benxi",name:"本溪市"},{code:"Dandong",name:"丹东市"},{code:"Jinzhou",name:"锦州市"},{code:"Yingkou",name:"营口市"},{code:"Fuxin",name:"阜新市"},{code:"Liaoyang",name:"辽阳市"},{code:"Panjin",name:"盘锦市"},{code:"Tieling",name:"铁岭市"},{code:"Chaoyang",name:"朝阳市"},{code:"Huludao",name:"葫芦岛市"}],code:"Liaoning",name:"辽宁"},220:{city:[{code:"Changchun",name:"长春市"},{code:"Jilin",name:"吉林市"},{code:"Siping",name:"四平市"},{code:"Liaoyuan",name:"辽源市"},{code:"Tonghua",name:"通化市"},{code:"Baishan",name:"白山市"},{code:"Songyuan",name:"松原市"},{code:"Baicheng",name:"白城市"},{code:"Yanbianchaoxianzu",name:"延边朝鲜族自治州"}],code:"Jilin",name:"吉林"},230:{city:[{code:"Haerbin",name:"哈尔滨市"},{code:"Qiqihaer",name:"齐齐哈尔市"},{code:"Jixi",name:"鸡西市"},{code:"Hegang",name:"鹤岗市"},{code:"Shuangyashan",name:"双鸭山市"},{code:"Daqing",name:"大庆市"},{code:"Yichun",name:"伊春市"},{code:"Jiamusi",name:"佳木斯市"},{code:"Qitaihe",name:"七台河市"},{code:"Mudanjiang",name:"牡丹江市"},{code:"Heihe",name:"黑河市"},{code:"Suihua",name:"绥化市"},{code:"Daxinganling",name:"大兴安岭地区"}],code:"Heilongjiang",name:"黑龙江"}}}).constant("APP_MEDIAQUERY",{desktopLG:1200,desktop:992,tablet:768,mobile:480}).constant("LANGUAGE",{datatable:{sLengthMenu:"每页显示 _MENU_条",sZeroRecords:"没有找到符合条件的数据",sProcessing:"&lt;img src=’./loading.gif’ /&gt;",sInfo:"当前第 _START_ - _END_ 条　共计 _TOTAL_ 条",sInfoEmpty:"没有记录",sInfoFiltered:"(从 _MAX_ 条记录中过滤)",sLoadingRecords:"加载中......",sSearch:"搜索：",oPaginate:{sFirst:"首页",sPrevious:"前一页",sNext:"后一页",sLast:"尾页"}}}).constant("DICT",{area:{"华北地区":!0,"东北地区":!0,"华东地区":!0,"华中地区":!0,"华南地区":!0,"西南地区":!0,"西北地区":!0,"其他地区":!0},dtTypeDict:[{value:1,name:"常用时间段"},{value:2,name:"自定义时间段"}],recentDict:[{value:3,name:"过去3天"},{value:5,name:"过去5天"},{value:7,name:"过去7天"}],funcs:[{name:"平均",value:"avg"},{name:"总共",value:"sum"},{name:"最大值",value:"max"},{name:"最小值",value:"min"}],regs:[{name:">",value:">"},{name:"<",value:"<"},{name:"=",value:"="},{name:"<=",value:"<="},{name:">=",value:">="}],tagType:{0:"实时标签",1:"延时标签",2:"自己导入"}}).constant("APP_REQUIRES",{scripts:{},modules:[{name:"ui.select",files:["vendor/angular-ui-select/dist/select.js","vendor/angular-ui-select/dist/select.css"]},{name:"datatables",files:["vendor/datatables/media/js/jquery.dataTables.js","vendor/angular-datatables/dist/angular-datatables.js","vendor/datatables-responsive/js/dataTables.responsive.js"],serie:!0},{name:"datetime",files:["vendor/angular-bootstrap-datetimepicker/src/css/datetimepicker.css","vendor/angular-bootstrap-datetimepicker/src/js/datetimepicker.js"]},{name:"ngDialog",files:["vendor/ngDialog/js/ngDialog.min.js","vendor/ngDialog/css/ngDialog.min.css","vendor/ngDialog/css/ngDialog-theme-default.min.css"]},{name:"daterangepicker",files:["vendor/bootstrap-daterangepicker/daterangepicker.css","vendor/bootstrap-daterangepicker/daterangepicker.js","vendor/angular-daterangepicker/js/angular-daterangepicker.js"]},{name:"fileupload",files:["vendor/jquery/plugins/fileupload.js"]}]}),angular.module("clickplus").controller("AppController",["$rootScope","$scope","$state","$window","$timeout","cfpLoadingBar",function(e,n,a,t,o,i){"use strict";var c;e.$on("$stateChangeStart",function(e,n,a,t,r){$(".wrapper > section").length&&(c=o(function(){i.start()},0))}),e.$on("$stateChangeSuccess",function(e,n,a,t,r){e.targetScope.$watch("$viewContentLoaded",function(){o.cancel(c),i.complete()})}),e.$on("$stateNotFound",function(e,n,a,t){console.log(n.to),console.log(n.toParams),console.log(n.options)}),e.$on("$stateChangeError",function(e,n,a,t,o,i){console.log(i)}),e.$on("$stateChangeSuccess",function(n,o,i,c,r){t.scrollTo(0,0),e.currTitle=a.current.title}),e.currTitle=a.current.title,e.pageTitle=function(){var n=e.app.name+" - "+(e.currTitle||e.app.description);return document.title=n,n}}]),function(){"use strict";function e(e,n){function a(){n.getResource({method:"get",url:"server/tags.json"}).then(function(n){e.tags=n;for(var a=0,t=e.tags.length;t>a;a++)e.tags[a].selected=!1;e.loading=!1})}function t(){n.getResource({url:"/people/name/used",data:{company:company_id,name:e.people.name}}).then(function(n){"used"==n?e.bNameExit=!0:e.bNameExit=!1})}function o(){""!=$.trim(e.people.name)&&0!=e.people.coverage?e.bVerifed=!0:e.bVerifed=!1}function i(n){e.bAdd=!e.bAdd,e.currentPage=1,e.addBoxLeft=$(n.target).offset().left-240,e.addBoxTop=$(n.target).offset().top-135}function c(n){e.people.tagItems.splice(n,1),s(),e.verification()}function r(){e.people.tagItems=[],e.people.coverage=0;for(var n=0,a=e.tags.length;a>n;n++)e.tags[n].selected&&e.people.tagItems.push(e.tags[n]);s(),e.bAdd=!1,e.verification()}function s(){for(var n=0,a=0,t=e.people.tagItems.length;t>a;a++)n+=e.people.tagItems[a].coverage;e.people.coverage=n}function l(){e.bAdd=!1}function d(){var a={};a.name=e.people.name,a.coverage=e.people.coverage,a.tags=[];for(var t=0,o=e.people.tagItems.length;o>t;t++)a.tags.push(e.people.tagItems[t].id);console.log(a),a.tags=JSON.stringify(a.tags),n.getResource({url:"/people/add",data:a}).then(function(n){alert("新增成功"),e.people={name:"",coverage:0,tagItems:[]}})}function g(){history.back()}e.loading=!0,e.bVerifed=!1,e.bNameExit=!1,e.bAdd=!1,e.people={name:"",coverage:0,tagItems:[]},e.selected={},e.filterText="",e.length=120,e.currentPage=1,e.addBoxLeft=0,e.addBoxTop=0,e.checkNameUni=t,e.verification=o,e.showAddTag=i,e.deleteTag=c,e.tagSave=r,e.tagCancel=l,e.save=d,e.cancel=g,a()}angular.module("clickplus").controller("PeopleAddController",e),e.$inject=["$scope","dataservice"]}(),function(){"use strict";function e(e,n,a){function t(){a.getResource({method:"get",url:"server/people.json"}).then(function(n){return n.tags=JSON.parse(n.tags),e.people=n,e.originName=e.people.name,e.people.tagItems=[],a.getResource({method:"get",url:"server/tags.json"})}).then(function(n){e.tags=n;for(var a=0,t=e.tags.length;t>a;a++)$.inArray(e.tags[a].id,e.people.tags)>-1?(e.tags[a].selected=!0,e.people.tagItems.push(e.tags[a])):e.tags[a].selected=!1;e.loading=!1})}function o(){e.people.name==e.originName?e.bNameExit=!1:a.getResource({url:"/people/name/used"}).then(function(n){"used"==n?e.bNameExit=!0:e.bNameExit=!1})}function i(){""!=$.trim(e.people.name)&&0!=e.people.coverage?e.bVerifed=!0:e.bVerifed=!1}function c(n){e.bAdd=!e.bAdd,e.currentPage=1,e.addBoxLeft=$(n.target).offset().left-240,e.addBoxTop=$(n.target).offset().top-135}function r(n){e.people.tagItems.splice(n,1),l(),e.verification()}function s(){e.people.tagItems=[],e.people.coverage=0;for(var n=0,a=e.tags.length;a>n;n++)e.tags[n].selected&&e.people.tagItems.push(e.tags[n]);e.bAdd=!1,e.verification()}function l(){for(var n=0,a=0,t=e.people.tagItems.length;t>a;a++)n+=e.people.tagItems[a].coverage;e.people.coverage=n}function d(){e.bAdd=!1}function g(){var n={id:e.people.id};n.name=e.people.name,n.coverage=e.people.coverage,n.tags=[];for(var t=0,o=e.people.tagItems.length;o>t;t++)n.tags.push(e.people.tagItems[t].id);console.log(n),n.tags=JSON.stringify(n.tags),a.getResource({url:"/people/update",data:n}).then(function(e){alert("修改成功")})}function u(){history.back()}e.loading=!0,e.bVerifed=!0,e.bAdd=!1,e.bNameExit=!1,e.selected={},e.filterText="",e.length=120,e.currentPage=1,e.addBoxLeft=0,e.addBoxTop=0,e.checkNameUni=o,e.verification=i,e.showAddTag=c,e.deleteTag=r,e.tagSave=s,e.tagCancel=d,e.save=g,e.cancel=u,t()}angular.module("clickplus").controller("PeopleEditController",e),e.$inject=["$scope","$stateParams","dataservice"]}(),function(){function e(e,n,a,t,o,i,c){"use strict";function r(n){var a='<table class="child"><thead><tr><th>创建时间</th><th>标签名称</th><th>创建人</th><th>覆盖人群</th><th style="width:200px;">操作</th></tr></thead><tbody>';for(var t in n)a+="<tr><td>"+moment(n[t].updateTime.time).format("YYYY-MM-DD HH:mm:ss")+"</td><td>"+n[t].name+"</td><td>"+e.users[n[t].memder]+"</td><td>"+n[t].coverage+'</td><td><a href="#/tag/edit/'+n[t].id+'">修改</a></td></tr>';return a+="</tbody></table>"}function s(){c.getResource({method:"get",url:"server/users.json"}).then(function(n){e.users={};for(var a=0,t=n.length;t>a;a++)e.users[n[a].id]=n[a].name;return c.getResource({method:"get",url:"server/peoples.json"})}).then(function(n){e.peoples=n,e.dtOptions.data=e.peoples,e.loading=!1})}function l(n){e.dtInstance.dataTable.fnFilter(n)}function d(e,n){console.log("toggleall");for(var a in n)n.hasOwnProperty(a)&&(n[a]=e)}function g(n){console.log("toggleone");for(var a in n)if(n.hasOwnProperty(a)&&!n[a])return void(e.selectAll=!1);e.selectAll=!0}function u(n,a){e.showCopy=!1,e.showDelete=!0,e.selectedId=n,e.deleteBoxLeft=$(a.target).offset().left-255,e.deleteBoxTop=$(a.target).offset().top-175}function m(){c.getResource({url:"/people/del",data:{id:e.selectedId}}).then(function(n){for(var a=0,t=e.peoples.length;t>a;a++)if(e.peoples[a].id==e.selectedId){e.peoples.splice(a,1);break}e.showDelete=!1})}function p(){e.showDelete=!1}function h(n,a,t){e.showDelete=!1,e.showCopy=!0,e.selectedId=n,e.copyName=a+"_副本",e.copyBoxLeft=$(t.target).offset().left-255,e.copyBoxTop=$(t.target).offset().top-175}function f(){c.getResource({url:"/people/copy",data:{id:e.selectedId,name:e.copyName}}).then(function(n){e.peoples.push(n),e.showCopy=!1})}function v(){e.showCopy=!1}e.loading=!0,e.selectAll=!1,e.showDelete=!1,e.showCopy=!1,e.peoples=null,e.dtInstance={},e.selected={},e.filter_value,e.selectedId=null,e.deleteBoxLeft=0,e.deleteBoxTop=0,e.copyBoxLeft=0,e.copyBoxTop=0,e.dtOptions={aoData:e.peoples,oLanguage:i.datatable,sDom:"t<li>p",fnHeaderCallback:function(n){o(angular.element(n).contents())(e)},fnCreatedRow:function(n,a,t){$(n).attr("id",a.id),o(angular.element(n).contents())(e)},aaSorting:[[1,"desc"]],responsive:{details:{type:"column",renderer:function(e,n){if(y.hasOwnProperty(n))return r(y[n]);var a='<div id="child_'+n+'">loading...</div>';e.cell(n,":hidden").data();return c.getResource({method:"get",url:"/server/people_tags.json"}).then(function(e){y[n]=e,$("#child_"+n).replaceWith(r(e))}),a}}},columnDefs:[{className:"control",orderable:!1,targets:0}]},e.dtColumns=[{sTitle:"",mData:null,sWidth:"10px",bSortable:!1,mRender:function(e,n,a){return""}},{sTitle:"创建时间",mData:"updateTime",mRender:function(e,n,a){return moment(e.time).format("YYYY-MM-DD HH:mm:ss")}},{sTitle:"人群名称",mData:"name",bSortable:!1},{sTitle:"创建人",mData:"memder",bSortable:!1,mRender:function(n,a,t){return e.users[n]}},{sTitle:"覆盖人群",mData:"coverage"},{sTitle:"操作",sWidth:"200px",mData:null,bSortable:!1,mRender:function(e,n,a){return'<a ng-href="#/people/edit/'+a.id+'">修改</a>&nbsp;<a  ng-click="showCopyBox('+a.id+", '"+a.name+'\', $event)">复制</a>&nbsp;<a  ng-click="showDeleteBox('+a.id+', $event)">删除</a>&nbsp;'}},{sTitle:"",mData:"tags",sClass:"none",mRender:function(e,n,a){return""}}],e.filte=l,e.toggleAll=d,e.toggleOne=g,e.showDeleteBox=u,e.doDelete=m,e.cancelDelete=p,e.showCopyBox=h,e.doCopy=f,e.cancelCopy=v;var y={};s()}angular.module("clickplus").controller("PeopleListController",e),e.$inject=["$scope","$resource","DTOptionsBuilder","DTColumnDefBuilder","$compile","LANGUAGE","dataservice"]}(),angular.module("clickplus").controller("SidebarController",["$rootScope","$scope","$state","$http","$timeout",function(e,n,a,t,o){var i=function(e){return e?a.is(e.sref)||a.includes(e.sref):void 0};n.getMenuItemPropClasses=function(e){return i(e)?" active":""}}]),function(){"use strict";function e(e,n,a,t,o){function i(){moment.locale("zh-cn");for(var n in t)for(var o in t[n]){for(var i=0,c=t[n][o].city.length;c>i;i++)t[n][o].city[i].selected=!0;t[n][o].selected=!0}e.region=t,a.getResource({method:"get",url:"server/sites.json"}).then(function(n){e.sites=n,e.loading=!1})}function c(){a.getResource({url:"/tags/name/used",data:{company:company_id,name:e.tag.name}}).then(function(n){"used"==n?e.bNameExit=!0:e.bNameExit=!1})}function r(){if(""==$.trim(e.tag.name)||e.tag.name.length>20)e.bVerifed=!1;else if(e.tag.des&&e.tag.des.length>100)e.bVerifed=!1;else if(e.tag.sites&&0!=e.tag.sites.length)if(0==e.tag.type)if(e.tag.begin&&""!=e.tag.begin)if(e.tag.end&&""!=e.tag.end){if(e.bVerifed=!0,!e.bOther||1!=e.tag.con.length||e.tag.con[0].hasOwnProperty("goal"))for(var n=0,a=e.tag.con.length;a>n;n++)if(e.tag.con[n].hasOwnProperty("goal")){var t=e.tag.con[n].goal.sites;if(t.length>1){for(var o=0,i=0,c=t.length;c>i;i++)t[i].selected&&o++;0==o&&(e.bVerifed=!1)}}else e.bVerifed=!1}else console.log(4),e.bVerifed=!1;else console.log(3),e.bVerifed=!1;else if(e.tag.hasOwnProperty("dtType"))if(1!=e.tag.dtType||e.tag.hasOwnProperty("recent"))if(2!=e.tag.dtType||e.tag.begin&&""!=e.tag.begin)if(2!=e.tag.dtType||e.tag.end&&""!=e.tag.end){if(e.bVerifed=!0,!e.bOther||1!=e.tag.con.length||e.tag.con[0].hasOwnProperty("goal"))for(var n=0,a=e.tag.con.length;a>n;n++)if(e.tag.con[n].hasOwnProperty("func"))if(e.tag.con[n].hasOwnProperty("reg"))if(e.tag.con[n].hasOwnProperty("value"))if(e.tag.con[n].hasOwnProperty("value")&&e.tag.con[n].value-0<=0)e.bVerifed=!1;else if(e.tag.con[n].hasOwnProperty("goal")){var t=e.tag.con[n].goal.sites;if(t.length>1){for(var o=0,i=0,c=t.length;c>i;i++)t[i].selected&&o++;0==o&&(e.bVerifed=!1)}}else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1}else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1}function s(){for(var n=[],a=0,t=e.sites.length;t>a;a++)$.inArray(e.sites[a].idsite,e.tag.sites)>-1&&n.push(e.sites[a]);0==n.length?e.events=n:e.events=l(n)}function l(e){for(var n=[],a={},t=0;t<e.length;t++)for(var o=e[t].goal,i=(e[t].idsite,e[t].name),c=[],r=0;r<o.length;r++){var s=o[r].goal_name;c=s in a?a[s]:[],c.push({event_id:o[r].goal_id,site_name:i}),a[s]=c}for(var l in a)n.push({event_name:l,sites:a[l]});return n}function d(){e.tag.con.push({}),r()}function g(n){e.tag.con.splice(n,1),r()}function u(){e.bOther=!0,r()}function m(n){for(var a in e.region[n]){for(var t=0,o=e.region[n][a].city.length;o>t;t++)e.region[n][a].city[t].selected=e.area[n];e.region[n][a].selected=e.area[n]}}function p(n,a){for(var t=0,o=e.region[n][a].city.length;o>t;t++)e.region[n][a].city[t].selected=e.region[n][a].selected;var i=!0;for(var a in e.region[n])if(!e.region[n][a].selected){i=!1;break}e.area[n]=i}function h(n,a){for(var t=!0,o=0,i=e.region[n][a].city.length;i>o;o++)if(!e.region[n][a].city[o].selected){t=!1;break}e.region[n][a].selected=t;var c=!0;for(var a in e.region[n])if(!e.region[n][a].selected){c=!1;break}e.area[n]=c}function f(){console.log(e.tag);var n={company:company_id};if(n.name=e.tag.name,n.des=e.tag.des,n.type=e.tag.type-0,1==n.type&&1==e.tag.dtType?n.recent=e.tag.recent:(n.begin=e.tag.begin,n.end=e.tag.end),n.con=[],1!=e.tag.con.length||e.tag.con[0].hasOwnProperty("goal"))for(var t=0,o=e.tag.con.length;o>t;t++){var i={};i.idsite=e.tag.sites,i.idgoal=[];var c=e.tag.con[t].goal;if(c.sites.length>1)for(var r=0,s=c.sites.length;s>r;r++)c.sites[r].selected&&i.idgoal.push(c.sites[r].event_id);else i.idgoal.push(c.sites[0].event_id);e.tag.con[t].func&&(i.func=e.tag.con[t].func),e.tag.con[t].reg&&(i.reg=e.tag.con[t].reg),e.tag.con[t].value&&(i.value=e.tag.con[t].value-0),n.con.push(i)}if(e.bOther){if(e.tag.source&&""!=e.tag.source){var i={};i.idsite=e.tag.sites,i.referer_url=$.trim(e.tag.source).split("\n"),n.con.push(i)}var i={};i.idsite=e.tag.sites,i.location_city=[];for(var l in e.region)for(var d in e.region[l]){for(var t=0,o=e.region[l][d].city.length;o>t;t++)e.region[l][d].city[t].selected&&i.location_city.push(e.region[l][d].city[t].code);e.region[l][d].selected&&e.region[l][d].city.length>1&&i.location_city.push(e.region[l][d].code)}n.con.push(i)}n.con=JSON.stringify(n.con),console.log(n),a.getResource({url:"/tags/add",data:n}).then(function(n){alert("新增成功"),e.bOther=!1,e.tag={type:0,con:[{}]}})}function v(){history.back()}function y(e){e.stopPropagation()}e.loading=!0,e.bOther=!1,e.bVerifed=!1,e.bNameExit=!1,e.tag={type:0,con:[{}]},e.region,e.area=o.area,e.dtTypeDict=o.dtTypeDict,e.recentDict=o.recentDict,e.funcs=o.funcs,e.regs=o.regs,e.events=[],e.sites=[],e.checkNameUni=c,e.verification=r,e.addGoalItem=d,e.deleteGoalItem=g,e.showOther=u,e.areaSelect=m,e.provinceSelect=p,e.citySelect=h,e.save=f,e.cancel=v,e.stop=y,e.selectSite=s,e.removeSite=s,i()}angular.module("clickplus").controller("TagAddController",e),e.$inject=["$scope","$http","dataservice","REGION","DICT"]}(),function(){"use strict";function e(e,n,a,t,o,i){function c(){u(e.tag.sites)}function r(){u(e.tag.sites)}function s(){moment.locale("zh-cn"),e.region=o,t.getResource({method:"get",url:"server/sites.json"}).then(function(n){return e.sites=n,t.getResource({method:"get",url:"server/tag.json"})}).then(function(n){var a=n[0];1==a.type?null!=a.recent?a.dtType=1:(a.dtType=2,a.begin=new Date(a.begin.time),a.end=new Date(a.end.time)):(a.begin=new Date(a.begin.time),a.end=new Date(a.end.time)),a.con=JSON.parse(a.con),a.sites=a.con[0].idsite,u(a.sites);for(var t=0,o=a.con.length;o>t;t++)a.con[t].hasOwnProperty("referer_url")&&(a.referer_url=a.con[t].referer_url,e.bOther=!0,a.con.splice(t,1));for(var t=0,o=a.con.length;o>t;t++)a.con[t].hasOwnProperty("location_city")&&(a.location_city=a.con[t].location_city,d(a.location_city,e.region),e.bOther=!0,a.con.splice(t,1));for(var t=0,o=a.con.length;o>t;t++)for(var i=0,c=e.events.length;c>i;i++)for(var r=e.events[i].sites,s=0,l=r.length;l>s;s++)$.inArray(r[s].event_id,a.con[t].idgoal)>-1&&(r[s].selected=!0,a.con[t].goal=e.events[i]);e.tag=a,e.loading=!1})}function l(){t.getResource({url:"/tags/name/used",data:{company:company_id,name:e.tag.name}}).then(function(n){"used"==n?e.bNameExit=!0:e.bNameExit=!1})}function d(n,a){for(var t in a)for(var o in a[t]){for(var i=0,c=a[t][o].city.length;c>i;i++)$.inArray(a[t][o].city[i].code,n)>-1?a[t][o].city[i].selected=!0:(a[t][o].city[i].selected=!1,e.area[t]=!1);$.inArray(a[t][o].code,n)>-1?a[t][o].selected=!0:(a[t][o].selected=!1,e.area[t]=!1)}}function g(){if(""==$.trim(e.tag.name)||e.tag.name.length>20)e.bVerifed=!1;else if(e.tag.des&&e.tag.des.length>100)e.bVerifed=!1;else if(e.tag.sites&&0!=e.tag.sites.length)if(0==e.tag.type)if(e.tag.begin&&""!=e.tag.begin)if(e.tag.end&&""!=e.tag.end){if(e.bVerifed=!0,!e.bOther||1!=e.tag.con.length||e.tag.con[0].hasOwnProperty("goal"))for(var n=0,a=e.tag.con.length;a>n;n++)if(e.tag.con[n].hasOwnProperty("goal")){
var t=e.tag.con[n].goal.sites;if(t.length>1){for(var o=0,i=0,c=t.length;c>i;i++)t[i].selected&&o++;0==o&&(e.bVerifed=!1)}}else e.bVerifed=!1}else console.log(4),e.bVerifed=!1;else console.log(3),e.bVerifed=!1;else if(e.tag.hasOwnProperty("dtType"))if(1!=e.tag.dtType||e.tag.hasOwnProperty("recent"))if(2!=e.tag.dtType||e.tag.begin&&""!=e.tag.begin)if(2!=e.tag.dtType||e.tag.end&&""!=e.tag.end){if(e.bVerifed=!0,!e.bOther||1!=e.tag.con.length||e.tag.con[0].hasOwnProperty("goal"))for(var n=0,a=e.tag.con.length;a>n;n++)if(e.tag.con[n].hasOwnProperty("func"))if(e.tag.con[n].hasOwnProperty("reg"))if(e.tag.con[n].hasOwnProperty("value"))if(e.tag.con[n].hasOwnProperty("value")&&e.tag.con[n].value-0<=0)e.bVerifed=!1;else if(e.tag.con[n].hasOwnProperty("goal")){var t=e.tag.con[n].goal.sites;if(t.length>1){for(var o=0,i=0,c=t.length;c>i;i++)t[i].selected&&o++;0==o&&(e.bVerifed=!1)}}else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1}else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1;else e.bVerifed=!1}function u(n){for(var a=[],t=0,o=e.sites.length;o>t;t++)$.inArray(e.sites[t].idsite,n)>-1&&a.push(e.sites[t]);0==a.length?e.events=a:e.events=m(a)}function m(e){for(var n=[],a={},t=0;t<e.length;t++)for(var o=e[t].goal,i=(e[t].idsite,e[t].name),c=[],r=0;r<o.length;r++){var s=o[r].goal_name;c=s in a?a[s]:[],c.push({event_id:o[r].goal_id,site_name:i}),a[s]=c}for(var l in a)n.push({event_name:l,sites:a[l]});return n}function p(){e.tag.con.push({}),g()}function h(n){e.tag.con.splice(n,1),g()}function f(){e.bOther=!0,g()}function v(n){for(var a in e.region[n]){for(var t=0,o=e.region[n][a].city.length;o>t;t++)e.region[n][a].city[t].selected=e.area[n];e.region[n][a].selected=e.area[n]}}function y(n,a){for(var t=0,o=e.region[n][a].city.length;o>t;t++)e.region[n][a].city[t].selected=e.region[n][a].selected;var i=!0;for(var a in e.region[n])if(!e.region[n][a].selected){i=!1;break}e.area[n]=i}function b(n,a){for(var t=!0,o=0,i=e.region[n][a].city.length;i>o;o++)if(!e.region[n][a].city[o].selected){t=!1;break}e.region[n][a].selected=t;var c=!0;for(var a in e.region[n])if(!e.region[n][a].selected){c=!1;break}e.area[n]=c}function T(){console.log(e.tag);var n={id:e.tag.id};if(n.name=e.tag.name,n.des=e.tag.des,n.type=e.tag.type-0,1==n.type&&1==e.tag.dtType?n.recent=e.tag.recent:(n.begin=e.tag.begin,n.end=e.tag.end),n.con=[],1!=e.tag.con.length||e.tag.con[0].hasOwnProperty("goal"))for(var a=0,o=e.tag.con.length;o>a;a++){var i={};i.idsite=e.tag.sites,i.idgoal=[];var c=e.tag.con[a].goal;if(c.sites.length>1)for(var r=0,s=c.sites.length;s>r;r++)c.sites[r].selected&&i.idgoal.push(c.sites[r].event_id);else i.idgoal.push(c.sites[0].event_id);e.tag.con[a].func&&(i.func=e.tag.con[a].func),e.tag.con[a].reg&&(i.reg=e.tag.con[a].reg),e.tag.con[a].value&&(i.value=e.tag.con[a].value-0),n.con.push(i)}if(e.bOther){if(e.tag.source&&""!=e.tag.source){var i={};i.idsite=e.tag.sites,i.referer_url=$.trim(e.tag.source).split("\n"),n.con.push(i)}var i={};i.idsite=e.tag.sites,i.location_city=[];for(var l in e.region)for(var d in e.region[l]){for(var a=0,o=e.region[l][d].city.length;o>a;a++)e.region[l][d].city[a].selected&&i.location_city.push(e.region[l][d].city[a].code);e.region[l][d].selected&&e.region[l][d].city.length>1&&i.location_city.push(e.region[l][d].code)}n.con.push(i)}n.con=JSON.stringify(n.con),console.log(n),t.getResource({url:"/tags/update",data:n}).then(function(e){alert("修改成功")})}function z(){history.back()}function w(e){e.stopPropagation()}e.loading=!0,e.bNameExit=!1,e.bOther=!1,e.bVerifed=!0,e.tag={type:0,con:[{}]},e.region,e.area=i.area,e.dtTypeDict=i.dtTypeDict,e.recentDict=i.recentDict,e.funcs=i.funcs,e.regs=i.regs,e.events=[],e.sites=[],e.checkNameUni=l,e.verification=g,e.addGoalItem=p,e.deleteGoalItem=h,e.showOther=f,e.areaSelect=v,e.provinceSelect=y,e.citySelect=b,e.save=T,e.cancel=z,e.stop=w,e.selectSite=c,e.removeSite=r,s()}angular.module("clickplus").controller("TagEditController",e),e.$inject=["$scope","$http","$stateParams","dataservice","REGION","DICT"]}(),angular.module("clickplus").controller("TagImportController",["$scope","$http",function(e,n){function a(){var e=$("#fileToUpload").val(),n=e.split(".")[e.split(".").length-1];return"csv"!=n&&"txt"!=n?(alert("请选择cvs或者txt文件"),!1):($("#fileToUpload")[0].disabled=!0,$("#fileToUploadLabel").addClass("disabled"),$("#uploadTips").text("文件正在上传中..."),void t())}function t(){return $.ajaxFileUpload({url:"/file/upload",secureuri:!1,fileElementId:"fileToUpload",dataType:"json",data:{},success:function(e,n){"undefined"!=typeof e.status&&("success"==e.status?$("#uploadTips").text("文件上传成功！"):($("#fileToUpload").val(""),"undefined"!=typeof e.message?alert(e.message):alert("上传错误！"),$("#fileToUpload")[0].disabled=!1,$("#fileToUploadLabel").removeClass("disabled"),$("#uploadTips").text("上传错误请重新选择文件上传")))},error:function(e,n,a){$("#uploadTips").text("上传错误请重新选择文件上传"),alert(a)}}),!1}e.loading=!1,e.tips="暂无文件，请根据数据规范，按格式编辑上传",e.upload=a}]),function(){"use strict";function e(e,n,a,t,o,i,c,r){function s(){c.getResource({method:"get",url:"server/users.json"}).then(function(n){e.users={};for(var a=0,t=n.length;t>a;a++)e.users[n[a].id]=n[a].name;return console.log(e.users),c.getResource({method:"get",url:"server/tags.json"})}).then(function(n){e.tags=n,e.dtOptions.data=e.tags,e.loading=!1})}function l(n){e.dtInstance.dataTable.fnFilter(n)}function d(e,n){for(var a in n)n.hasOwnProperty(a)&&(n[a]=e)}function g(n){for(var a in n)if(n.hasOwnProperty(a)&&!n[a])return void(e.selectAll=!1);e.selectAll=!0}function u(n){e.searchingPeople=!0,e.showDelete=!0,e.selectedId=n,e.deleteBoxLeft=$(event.target).offset().left-255,e.deleteBoxTop=$(event.target).offset().top-175,c.getResource({url:"/tags/query/people",data:{id:n}}).then(function(n){if(n.length>0){for(var a="该标签已经被",t=[],o=0,i=n.length;i>o;o++)t.push('"'+n[o].name+'"');a+=t.join(",")+"营销人群应用，删除之后会造成一定影响！",e.searchingResult=a}else e.searchingResult="";e.searchingPeople=!1})}function m(n){c.getResource({url:"/tags/del",data:{id:e.selectedId}}).then(function(n){for(var a=0,t=e.tags.length;t>a;a++)if(e.tags[a].id==e.selectedId){e.tags.splice(a,1);break}e.showDelete=!1})}function p(n){e.showDelete=!1}function h(){var n=[];for(var a in e.selected)e.selected[a]&&n.push(a);0==n.length?alert("请先选择需要导出的标签"):e.exportConfirm=!0}function f(){var n=[];for(var a in e.selected)e.selected[a]&&n.push(a);var t="/file/download?tag_list="+n.join(",");y(t),e.exportConfirm=!1}function v(){e.exportConfirm=!1}function y(e){var n=document.createElement("iframe");n.src=e,n.style.display="none",document.body.appendChild(n)}e.exportConfirm=!1,e.searchingPeople=!1,e.loading=!0,e.selectAll=!1,e.showDelete=!1,e.selectedId=null,e.deleteBoxLeft=0,e.deleteBoxTop=0,e.deleteShowDict={},e.dtInstance={},e.selected={},e.tags=null,e.filter_value,e.dtOptions={aoData:e.tags,oLanguage:i.datatable,sDom:"t<li>p",sPaginationType:"full_numbers",aaSorting:[[5,"desc"]],fnHeaderCallback:function(n){o(angular.element(n).contents())(e)},fnCreatedRow:function(n,a,t){o(angular.element(n).contents())(e)}};var b='<input type="checkbox" ng-model="selectAll" ng-click="toggleAll(selectAll, selected)">';e.dtColumns=[{sTitle:"",mData:"id",sWidth:"0",bVisible:!1,bSortable:!1},{sTitle:b,mData:"id",sWidth:"10px",bSortable:!1,mRender:function(n,a,t){return e.selected[t.id]=!1,'<input type="checkbox" id="'+t.id+'" ng-model="selected['+t.id+']" ng-click="toggleOne(selected)">'}},{sTitle:"标签名",mData:"name",bSortable:!1},{sTitle:"标签描述",mData:"des",bSortable:!1},{sTitle:"创建人",mData:"memder",bSortable:!1,mRender:function(n,a,t){return e.users[n]}},{sTitle:"创建时间",mData:"updateTime",mRender:function(e,n,a){return moment(e.time).format("YYYY-MM-DD HH:mm:ss")}},{sTitle:"覆盖人群",mData:null,mRender:function(e,n,a){return a.coverage>-1?a.coverage:"正在生成中..."}},{sTitle:"标签类型",mData:"type",mRender:function(e,n,a){return r.tagType[e]}},{sTitle:"操作",mData:null,bSortable:!1,mRender:function(n,a,t){return e.deleteShowDict[t.id]=!1,(2==t.type?"":'<a ng-href="#/tag/edit/'+t.id+'">修改</a>&nbsp;')+'<a  ng-click="showDeleteBox('+t.id+')">删除</a>&nbsp;'}}],e.exportTag=f,e.exportCheck=h,e.exportCancel=v,e.exportTag=f,e.filte=l,e.toggleAll=d,e.toggleOne=g,e.showDeleteBox=u,e.doDelete=m,e.cancelDelete=p,s()}angular.module("clickplus").controller("TagListController",e),e.$inject=["$scope","$resource","DTOptionsBuilder","DTColumnBuilder","$compile","LANGUAGE","dataservice","DICT"]}(),angular.module("clickplus").service("browser",function(){"use strict";var e,n,a=function(e){e=e.toLowerCase();var n=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],a=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/i.exec(e)||[];return{browser:n[3]||n[1]||"",version:n[2]||"0",platform:a[0]||""}};if(e=a(window.navigator.userAgent),n={},e.browser&&(n[e.browser]=!0,n.version=e.version,n.versionNumber=parseInt(e.version)),e.platform&&(n[e.platform]=!0),(n.android||n.ipad||n.iphone||n["windows phone"])&&(n.mobile=!0),(n.cros||n.mac||n.linux||n.win)&&(n.desktop=!0),(n.chrome||n.opr||n.safari)&&(n.webkit=!0),n.rv){var t="msie";e.browser=t,n[t]=!0}if(n.opr){var o="opera";e.browser=o,n[o]=!0}if(n.safari&&n.android){var i="android";e.browser=i,n[i]=!0}return n.name=e.browser,n.platform=e.platform,n}),function(){"use strict";function e(e,n,a){function t(a){var t={method:"post",dataType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}};return $.extend(t,a),t.data=JSON.stringify(t.data),e(t).then(function(e){var a=e.data;return a.success?a.data:void(-1==a.code?n.url("/user/login"):console.log("返回数据格式有问题"))})["catch"](function(e){console.log("异步请求失败")})}var o={getResource:t};return o}angular.module("clickplus").factory("dataservice",e),e.$inject=["$http","$location","$q"]}(),angular.module("clickplus").service("Notify",["$timeout",function(e){function n(n,a){n&&e(function(){$.notify(n,a||{})})}this.alert=n}]),function(e,n,a){var t={},o={},i=function(n){return"string"==e.type(n)&&(n={message:n}),arguments[1]&&(n=e.extend(n,"string"==e.type(arguments[1])?{status:arguments[1]}:arguments[1])),new r(n).show()},c=function(e,n){if(e)for(var a in o)e===o[a].group&&o[a].close(n);else for(var a in o)o[a].close(n)},r=function(n){this.options=e.extend({},r.defaults,n),this.uuid="ID"+(new Date).getTime()+"RAND"+Math.ceil(1e5*Math.random()),this.element=e(['<div class="uk-notify-message alert-dismissable">','<a class="close">&times;</a>',"<div>"+this.options.message+"</div>","</div>"].join("")).data("notifyMessage",this),this.options.status&&(this.element.addClass("alert alert-"+this.options.status),this.currentstatus=this.options.status),this.group=this.options.group,o[this.uuid]=this,t[this.options.pos]||(t[this.options.pos]=e('<div class="uk-notify uk-notify-'+this.options.pos+'"></div>').appendTo("body").on("click",".uk-notify-message",function(){e(this).data("notifyMessage").close()}))};return e.extend(r.prototype,{uuid:!1,element:!1,timout:!1,currentstatus:"",group:!1,show:function(){if(!this.element.is(":visible")){var e=this;t[this.options.pos].show().prepend(this.element);var n=parseInt(this.element.css("margin-bottom"),10);return this.element.css({opacity:0,"margin-top":-1*this.element.outerHeight(),"margin-bottom":0}).animate({opacity:1,"margin-top":0,"margin-bottom":n},function(){if(e.options.timeout){var n=function(){e.close()};e.timeout=setTimeout(n,e.options.timeout),e.element.hover(function(){clearTimeout(e.timeout)},function(){e.timeout=setTimeout(n,e.options.timeout)})}}),this}},close:function(e){var n=this,a=function(){n.element.remove(),t[n.options.pos].children().length||t[n.options.pos].hide(),delete o[n.uuid]};this.timeout&&clearTimeout(this.timeout),e?a():this.element.animate({opacity:0,"margin-top":-1*this.element.outerHeight(),"margin-bottom":0},function(){a()})},content:function(e){var n=this.element.find(">div");return e?(n.html(e),this):n.html()},status:function(e){return e?(this.element.removeClass("alert alert-"+this.currentstatus).addClass("alert alert-"+e),this.currentstatus=e,this):this.currentstatus}}),r.defaults={message:"",status:"normal",timeout:5e3,group:null,pos:"top-center"},e.notify=i,e.notify.message=r,e.notify.closeAll=c,i}(jQuery,window,document),angular.module("clickplus").provider("RouteHelpers",["APP_REQUIRES",function(e){"use strict";this.basepath=function(e){return"app/views/"+e},this.resolveFor=function(){var n=arguments;return{deps:["$ocLazyLoad","$q",function(a,t){function o(e){return"function"==typeof e?c.then(e):c.then(function(){var n=i(e);return n?a.load(n):$.error("Route resolve: Bad resource name ["+e+"]")})}function i(n){if(e.modules)for(var a in e.modules)if(e.modules[a].name&&e.modules[a].name===n)return e.modules[a];return e.scripts&&e.scripts[n]}for(var c=t.when(1),r=0,s=n.length;s>r;r++)c=o(n[r]);return c}]}},this.$get=function(){return{basepath:this.basepath}}}]),angular.module("clickplus").filter("PaginationFilter",function(){return function(e,n,a){e=e||[];var t=e.length,o=[],i=t%n==0?t/n:Math.floor(t/n)+1;if(1>=i)for(var c=0;t>c;c++)o.push(e[c]);else if(i==a)for(var c=(a-1)*n;t>c;c++)o.push(e[c]);else for(var c=(a-1)*n,r=a*n;r>c;c++)o.push(e[c]);return o}}),angular.module("clickplus").filter("showSiteName",function(){return function(e){e=e||[];for(var n=[],a=0,t=e.length;t>a;a++)e[a].selected&&n.push(e[a].site_name);return 0==n.length?"网站(可多选)":n.join("+")}});